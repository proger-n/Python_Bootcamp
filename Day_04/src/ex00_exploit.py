from bs4 import BeautifulSoup
html_path = "../materials/evilcorp.html"
with open(html_path, "r+") as html:
    html_doc = html.read()
    soup = BeautifulSoup(html_doc, 'html.parser')
    title = soup.find("title")
    title.string = "Evil Corp - Stealing your money every day"
    name = soup.find("span", {"class": "name"}).text
    h1_tag = soup.new_tag("h1")
    h1_tag.string = f"{name}, you are hacked!"
    soup.p.insert_before(h1_tag)
    script = """hacked = function() {
            alert('hacked');
        }
        window.addEventListener('load', 
          function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
          },
          false
        );
    """
    but = soup.new_tag("script")
    but.string = script
    soup.form.findChildren("input")[-1].insert_after(but)
    new_a = soup.new_tag("a", href="https://mrrobot.fandom.com/wiki/Fsociety")
    new_a.string = "Fsociety"
    soup.a.replace_with(new_a)
    with open("../materials/evilcorp_hacked.html", "wb") as file:
        file.write(soup.prettify("utf-8"))
